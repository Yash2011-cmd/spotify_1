<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Music Player</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <nav class="navbar">
    <ul>
      <img class="logof" src="Screenshot 2025-11-07 211226.png" alt="Logo">
      <img class="Homef" src="Screenshot 2025-11-07 211311.png" alt="Home">
      <input id="search" class="sc" type="search" placeholder="What do you want to play">
      <li>Premium</li>
      <li>Support</li>
      <li>Download</li>
      <img class="pic" src="Screenshot 2025-11-08 131259.png" alt="Profile">
      <li>Install</li>
      <li>Sign up</li>
      <li>Login</li>
    </ul>
  </nav>

  <main>
    <div class="containermain" id="grid">

      <div class="card" data-title="Supreme - Shubh">
        <div class="thumb">
          <img src="Screenshot 2025-11-07 203805.png" alt="Supreme - Shubh">
          <div class="overlay"><button class="playbtn" aria-label="Play">‚ñ∂</button></div>
        </div>
        <audio src="Supreme - Shubh.mp3"></audio>
      </div>

      <div class="card" data-title="videoplayback (2)">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110752.png" alt="videoplayback (2)">
          <div class="overlay"><button class="playbtn" aria-label="Play">‚ñ∂</button></div>
        </div>
        <audio src="videoplayback (2).m4a"></audio>
      </div>

      <div class="card" data-title="Ayee Na Humara Bihar Main">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110801.png" alt="Ayee Na Humara Bihar Main">
          <div class="overlay"><button class="playbtn" aria-label="Play">‚ñ∂</button></div>
        </div>
        <audio src="Ayee_Na_Humara_Bihar_Main.mp3"></audio>
      </div>

      <div class="card" data-title="Aaj Ki Raat Stree 2">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110821.png" alt="Aaj Ki Raat Stree 2">
          <div class="overlay"><button class="playbtn" aria-label="Play">‚ñ∂</button></div>
        </div>
        <audio src="Aaj Ki Raat Stree 2 128 Kbps.mp3"></audio>
      </div>

      <div class="card" data-title="Bollywood Central">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110828.png" alt="Bollywood Central">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Hot Hits">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110839.png" alt="Hot Hits">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Punjabi 101">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110905.png" alt="Punjabi 101">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Indie India">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 111129.png" alt="Indie India">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Radar India">
        <div class="thumb">
          <img src="Screenshot 2025-11-07 203805.png" alt="Radar India">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Tollywood Pearls">
        <div class="thumb">
          <img src="Screenshot 2025-11-09 110655.png" alt="Tollywood Pearls">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Sufi & Bollywood">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132952.png" alt="Sufi & Bollywood">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Sufi Collection">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132917.png" alt="Sufi Collection">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Cream">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132903.png" alt="Cream">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Sample 1">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132846.png" alt="Sample 1">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Sample 2">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132831.png" alt="Sample 2">
          <div class="overlay"></div>
        </div>
      </div>

      <div class="card" data-title="Sample 3">
        <div class="thumb">
          <img src="Screenshot 2025-11-13 132817.png" alt="Sample 3">
          <div class="overlay"></div>
        </div>
      </div>

    </div>
  </main>

  <div class="player" id="player">
    <div class="player-left">
      <img id="player-art" src="" alt="">
      <div class="meta">
        <div id="player-title" class="title">No track selected</div>
        <div id="player-time" class="time">0:00 / 0:00</div>
      </div>
    </div>

    <div class="player-center">
      <div class="btns">
        <button id="prev" class="control" title="Previous">‚ü®</button>
        <button id="play" class="control" title="Play">‚ñ∂</button>
        <button id="next" class="control" title="Next">‚ü©</button>
      </div>
      <div class="progress-wrap">
        <input id="progress" type="range" min="0" max="100" value="0">
      </div>
    </div>

    <div class="player-right">
      <button id="shuffle" class="control" title="Shuffle">üîÄ</button>
      <button id="repeat" class="control" title="Repeat">üîÅ</button>
      <div class="vol-wrap">
        <input id="volume" type="range" min="0" max="1" step="0.01" value="0.9">
      </div>
      <button id="mute" class="control" title="Mute">üîà</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      (function preloadFix(){
        const imgs = document.querySelectorAll('.thumb img');
        imgs.forEach(img => {
          const raw = (img.getAttribute('src') || '').trim();
          if (!raw) {
            img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="450"><rect width="100%" height="100%" fill="%23eee"/><text x="50%" y="50%" fill="%23999" font-size="20" text-anchor="middle" dy=".3em">No image</text></svg>';
            return;
          }
          const encoded = raw.split('/').map(part => encodeURIComponent(part)).join('/');
          if (encoded !== raw) img.setAttribute('src', encoded);
          const pre = new Image();
          pre.onload = () => { img.style.opacity = '1'; };
          pre.onerror = () => {
            img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="450"><rect width="100%" height="100%" fill="%23eee"/><text x="50%" y="50%" fill="%23999" font-size="20" text-anchor="middle" dy=".3em">Image not found</text></svg>';
          };
          pre.src = img.getAttribute('src');
          img.style.opacity = '0';
          img.style.transition = 'opacity .28s ease';
        });
      })();

      const grid = document.getElementById('grid');
      const cards = Array.from(grid.querySelectorAll('.card'));

      // Use getAttribute('src') to detect presence of audio attribute reliably
      const playable = cards.filter(c => {
        const a = c.querySelector('audio');
        return a && ( (a.getAttribute('src') || '').trim() !== '' );
      });

      const playBtn = document.getElementById('play');
      const prevBtn = document.getElementById('prev');
      const nextBtn = document.getElementById('next');
      const muteBtn = document.getElementById('mute');
      const progress = document.getElementById('progress');
      const playerTitle = document.getElementById('player-title');
      const playerTime = document.getElementById('player-time');
      const playerArt = document.getElementById('player-art');
      const shuffleBtn = document.getElementById('shuffle');
      const repeatBtn = document.getElementById('repeat');
      const volumeSlider = document.getElementById('volume');

      let currentIndex = -1;
      let currentAudio = null;
      let progressTimer = null;
      let shuffle = false;
      let repeatMode = 0;

      function formatTime(s){
        if (isNaN(s)) return '0:00';
        const m = Math.floor(s/60);
        const sec = Math.floor(s%60).toString().padStart(2,'0');
        return `${m}:${sec}`;
      }

      function highlightCard(card){
        cards.forEach(c => c.classList.remove('active'));
        if (card) card.classList.add('active');
      }

      function setTrack(index){
        if (playable.length === 0) return;
        if (index < 0 || index >= playable.length) return;
        if (currentAudio){
          currentAudio.pause();
          currentAudio.currentTime = 0;
        }
        currentIndex = index;
        const card = playable[currentIndex];
        const audio = card.querySelector('audio');
        currentAudio = audio;

        // ensure metadata gets loaded for duration info
        if (audio && audio.preload !== 'metadata') audio.preload = 'metadata';

        const img = card.querySelector('img');
        playerArt.src = img ? img.src : '';
        playerTitle.textContent = card.dataset.title || (audio.getAttribute('src')?.split('/').pop() || 'Unknown');
        audio.volume = Number(volumeSlider.value);
        audio.currentTime = 0;
        playAudio();
        highlightCard(card);
      }

      function playAudio(){
        if (!currentAudio){
          if (playable.length > 0) setTrack(0);
          return;
        }
        document.querySelectorAll('audio').forEach(a => { if (a !== currentAudio) a.pause(); });
        // play may return a promise ‚Äî handle potential rejections (autoplay policies)
        const p = currentAudio.play();
        if (p && p.catch) p.catch(err => {
          // autoplay blocked: change play button state but do not throw
          playBtn.textContent = '‚ñ∂';
        });
        playBtn.textContent = '‚ùö‚ùö';
        startProgress();
      }

      function pauseAudio(){
        if (!currentAudio) return;
        currentAudio.pause();
        playBtn.textContent = '‚ñ∂';
        stopProgress();
      }

      function startProgress(){
        stopProgress();
        progressTimer = setInterval(()=> {
          if (!currentAudio) return;
          const ct = currentAudio.currentTime;
          const dur = currentAudio.duration || 0;
          const pct = dur ? (ct/dur)*100 : 0;
          progress.value = pct;
          playerTime.textContent = `${formatTime(ct)} / ${formatTime(dur)}`;
          if (dur && ct >= dur - 0.25){
            onTrackEnd();
          }
        }, 300);
      }

      function stopProgress(){
        if (progressTimer) clearInterval(progressTimer);
        progressTimer = null;
      }

      function getNextIndex(){
        if (shuffle && playable.length > 1){
          let rnd;
          do { rnd = Math.floor(Math.random() * playable.length); } while (rnd === currentIndex);
          return rnd;
        }
        return (currentIndex + 1) % playable.length;
      }

      function nextTrack(){
        if (playable.length === 0) return;
        if (shuffle && playable.length > 1){
          setTrack(getNextIndex());
          return;
        }
        setTrack((currentIndex + 1) % playable.length);
      }

      function prevTrack(){
        if (playable.length === 0) return;
        setTrack((currentIndex - 1 + playable.length) % playable.length);
      }

      function onTrackEnd(){
        if (!currentAudio) return;
        if (repeatMode === 1){
          currentAudio.currentTime = 0;
          playAudio();
          return;
        }
        if (repeatMode === 2){
          nextTrack();
          return;
        }
        if (shuffle){
          setTrack(getNextIndex());
          return;
        }
        const next = currentIndex + 1;
        if (next < playable.length) setTrack(next);
        else {
          pauseAudio();
          currentAudio.currentTime = 0;
        }
      }

      grid.addEventListener('click', e => {
        const btn = e.target.closest('.playbtn');
        if (!btn) return;
        const card = e.target.closest('.card');
        const idx = playable.indexOf(card);
        if (idx === -1) return;
        if (currentIndex === idx){
          if (currentAudio && !currentAudio.paused) pauseAudio();
          else playAudio();
        } else {
          setTrack(idx);
        }
      });

      playBtn.addEventListener('click', () => {
        if (!currentAudio) { setTrack(0); return; }
        if (currentAudio.paused) playAudio(); else pauseAudio();
      });

      nextBtn.addEventListener('click', nextTrack);
      prevBtn.addEventListener('click', prevTrack);

      muteBtn.addEventListener('click', () => {
        if (!currentAudio) return;
        currentAudio.muted = !currentAudio.muted;
        muteBtn.textContent = currentAudio.muted ? 'üîá' : 'üîà';
      });

      volumeSlider.addEventListener('input', () => {
        const v = Number(volumeSlider.value);
        if (currentAudio) currentAudio.volume = v;
        if (v === 0) muteBtn.textContent = 'üîá';
        else muteBtn.textContent = 'üîà';
      });

      progress.addEventListener('input', () => {
        if (!currentAudio || !currentAudio.duration) return;
        const pct = Number(progress.value);
        currentAudio.currentTime = (pct/100) * currentAudio.duration;
        startProgress();
      });

      document.addEventListener('keydown', e => {
        if (e.code === 'Space') {
          e.preventDefault();
          if (!currentAudio) setTrack(0);
          else if (currentAudio.paused) playAudio(); else pauseAudio();
        }
        if (e.key === 'ArrowRight') nextTrack();
        if (e.key === 'ArrowLeft') prevTrack();
      });

      const search = document.getElementById('search');
      search.addEventListener('input', () => {
        const q = search.value.trim().toLowerCase();
        cards.forEach(card => {
          const title = (card.dataset.title || '').toLowerCase();
          const alt = (card.querySelector('img')?.alt || '').toLowerCase();
          const audioAttr = (card.querySelector('audio')?.getAttribute('src') || '').toLowerCase();
          const matches = !q || title.includes(q) || alt.includes(q) || audioAttr.includes(q);
          card.style.display = matches ? '' : 'none';
        });
      });

      playable.forEach((card, i) => {
        const a = card.querySelector('audio');
        if (!a) return;
        a.addEventListener('play', () => {
          highlightCard(card);
          playBtn.textContent = '‚ùö‚ùö';
          playerTitle.textContent = card.dataset.title || a.getAttribute('src')?.split('/').pop();
          const img = card.querySelector('img');
          playerArt.src = img ? img.src : '';
        });
        a.addEventListener('pause', () => {
          playBtn.textContent = '‚ñ∂';
        });
        a.addEventListener('loadedmetadata', () => {
          if (currentAudio === a) {
            playerTime.textContent = `${formatTime(a.currentTime)} / ${formatTime(a.duration)}`;
          }
        });
        a.addEventListener('ended', onTrackEnd);
      });

      shuffleBtn.addEventListener('click', () => {
        shuffle = !shuffle;
        shuffleBtn.style.opacity = shuffle ? '1' : '0.65';
        shuffleBtn.style.transform = shuffle ? 'translateY(-2px)' : 'none';
      });

      repeatBtn.addEventListener('click', () => {
        repeatMode = (repeatMode + 1) % 3;
        if (repeatMode === 0) { repeatBtn.textContent = 'üîÅ'; repeatBtn.title = 'Repeat: off'; repeatBtn.style.opacity = '0.65'; }
        if (repeatMode === 1) { repeatBtn.textContent = 'üîÇ'; repeatBtn.title = 'Repeat: one'; repeatBtn.style.opacity = '1'; }
        if (repeatMode === 2) { repeatBtn.textContent = 'üîÅ'; repeatBtn.title = 'Repeat: all'; repeatBtn.style.opacity = '1'; }
      });

      window.addEventListener('beforeunload', () => {
        stopProgress();
        document.querySelectorAll('audio').forEach(a => a.pause());
      });

      // If you want auto-select the first playable track on page load, uncomment:
      // if (playable.length > 0) setTrack(0);
    });
  </script>

</body>
</html>
